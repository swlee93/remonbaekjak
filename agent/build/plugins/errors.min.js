!function(e,r){"use strict";e.ErrorStackParser=r()}(this,function(){"use strict";var r=/(^|@)\S+\:\d+/,n=/^\s*at .*(\S+\:\d+|\(native\))/m,t=/^(eval@)?(\[native code\])?$/;function o(e,r,n){if("function"==typeof Array.prototype.map)return e.map(r,n);for(var t=new Array(e.length),o=0;o<e.length;o++)t[o]=r.call(n,e[o]);return t}function i(e,r,n){if("function"==typeof Array.prototype.filter)return e.filter(r,n);for(var t=[],o=0;o<e.length;o++)r.call(n,e[o])&&t.push(e[o]);return t}return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(n))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var r=e.replace(/[\(\)\s]/g,"").split(":"),n=r.pop(),e=r[r.length-1];if(isNaN(parseFloat(e))||!isFinite(e))return[r.join(":"),n,void 0];e=r.pop();return[r.join(":"),e,n]},parseV8OrIE:function(e){return o(i(e.stack.split("\n"),function(e){return!!e.match(n)},this),function(e){var r=(e=-1<e.indexOf("(eval ")?e.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""):e).replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),n=this.extractLocation(r.pop());return{functionName:r.join(" ")||void 0,fileName:"eval"===n[0]?void 0:n[0],lineNumber:n[1],columnNumber:n[2],source:e}},this)},parseFFOrSafari:function(e){return o(i(e.stack.split("\n"),function(e){return!e.match(t)},this),function(e){if(-1===(e=-1<e.indexOf(" > eval")?e.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1"):e).indexOf("@")&&-1===e.indexOf(":"))return{functionName:e};var r=e.split("@"),n=this.extractLocation(r.pop());return{functionName:r.join("@")||void 0,fileName:n[0],lineNumber:n[1],columnNumber:n[2],source:e}},this)},parseOpera:function(e){return!e.stacktrace||-1<e.message.indexOf("\n")&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var r=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split("\n"),t=[],o=2,i=n.length;o<i;o+=2){var s=r.exec(n[o]);s&&t.push({fileName:s[2],lineNumber:s[1],source:n[o]})}return t},parseOpera10:function(e){for(var r=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split("\n"),t=[],o=0,i=n.length;o<i;o+=2){var s=r.exec(n[o]);s&&t.push({functionName:s[3]||void 0,fileName:s[2],lineNumber:s[1],source:n[o]})}return t},parseOpera11:function(e){return o(i(e.stack.split("\n"),function(e){return!!e.match(r)&&!e.match(/^Error created at/)},this),function(e){var r,n=e.split("@"),t=this.extractLocation(n.pop()),n=n.shift()||"";return{functionName:n.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0,args:void 0===(r=n.match(/\(([^\)]*)\)/)?n.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"):r)||"[arguments not available]"===r?void 0:r.split(","),fileName:t[0],lineNumber:t[1],columnNumber:t[2],source:e}},this)}}});!function(){BOOMR=window.BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};if(!BOOMR.plugins.Errors){var p=["BOOMR_addError","createStackForSend","BOOMR.window.console.error","BOOMR.plugins.Errors.init","BOOMR.window.onerror","BOOMR_plugins_errors_"],O=["Object.send","b.send","wrap","Anonymous function"],d=["/boomerang"];N.prototype.equals=function(e){return"object"==typeof e&&(this.code===e.code&&(this.message===e.message&&(this.functionName===e.functionName&&(this.fileName===e.fileName&&(this.lineNumber===e.lineNumber&&(this.columnNumber===e.columnNumber&&(this.stack===e.stack&&(this.type===e.type&&this.source===e.source))))))))};var m={onError:void 0,monitorGlobal:!0,monitorNetwork:!0,monitorConsole:!0,monitorEvents:!(N.fromError=function(e,r,n){var t,o,i,s,a,u,l,c,m=!1,f=BOOMR.now();if(!e)return null;if(e.stack){5e3<e.stack.length&&(e.stack=e.stack.substr(0,5e3));if((o=ErrorStackParser.parse(e))&&o.length){if(e.generatedStack){if(4<=o.length&&o[1].functionName&&-1!==o[1].functionName.indexOf("createStackForSend")){o=o.slice(3);m=!0}if(3<=o.length&&o[0].functionName&&-1!==o[0].functionName.indexOf("createStackForSend")){o=o[1].fileName===o[2].fileName?o.slice(3):o.slice(2);m=!0}if(1<=o.length&&o[0].functionName&&-1!==o[0].functionName.indexOf("BOOMR_plugins_errors")){o=o.slice(1);m=!0}}for(i=0;i<o.length;i++){u=!1;if(c=(l=o[i]).functionName){for(s=0;s<p.length;s++)if(-1!==c.indexOf(p[s])){o.splice(i,1);i--;u=m=!0;break}if(!u&&l.fileName)for(s=0;s<d.length;s++)if(-1!==l.fileName.indexOf(d[s]))for(a=0;a<O.length;a++)if(-1!==c.indexOf(O[a])){o.splice(i,1);i--;u=m=!0;break}}}if(o.length){t=o[0];!m&&void 0!==e.lineNumber||(e.lineNumber=t.lineNumber);!m&&void 0!==e.columnNumber||(e.columnNumber=t.columnNumber);!m&&void 0!==e.functionName||(e.functionName=t.functionName);!m&&void 0!==e.fileName||(e.fileName=t.fileName)}e.stack&&(e.stack=e.stack.replace(/\s\s+/g," "))}}else(e.functionName||e.fileName||e.lineNumber||e.columnNumber)&&(o=[{lineNumber:e.lineNumber,columnNumber:e.columnNumber,fileName:e.fileName,functionName:e.functionName}]);"string"==typeof e.message&&"function"==typeof e.message.indexOf&&-1!==e.message.indexOf("ReferenceError:")&&"Error"===e.name&&(e.name="ReferenceError");return new N({code:e.code||void 0,message:e.message||void 0,functionName:e.functionName||void 0,fileName:e.fileName||void 0,lineNumber:e.lineNumber||void 0,columnNumber:e.columnNumber||void 0,stack:e.stack||void 0,type:e.name||void 0,source:n,via:r,frames:o,extra:e.extra||void 0,timestamp:e.timestamp||f})}),monitorTimeout:!1,monitorRejections:!1,monitorReporting:!1,sendAfterOnload:!1,maxErrors:10,sendInterval:1e3,sendIntervalDuringLoad:2500,sendIntervalId:-1,maxEvents:10,isDuringLoad:!0,initialized:!1,autorun:!0,errors:[],q:[],events:[],reportingObserver:void 0,send:function(r,n,t){var o=BOOMR.now();if(r&&!0!==r.reported){r.reported=!0;n=n||BOOMR.plugins.Errors.VIA_APP;t=t||BOOMR.plugins.Errors.SOURCE_APP;if(r.stack||r.noStack){r.timestamp=r.timestamp||o;m.addError(r,n,t)}else!function(){try{throw Error(r)}catch(e){(r=e).generatedStack=!0;r.timestamp=r.timestamp||o;m.addError(r,n,t)}}()}},addError:function(e,r,n){var t,o,i=BOOMR.now();if(m.isDuringLoad||m.sendAfterOnload){if(m.onError){try{t=m.onError(e)}catch(e){t=!1}if(!t)return}if(!(m.errors.length>=m.maxErrors)){n=N.fromError(e,r,n);o=m.mergeDuplicateErrors(m.errors,n,!1);BOOMR.fireEvent("error",o||n);m.mergeDuplicateErrors(m.q,n,!0);!BOOMR.hasSentPageLoadBeacon()&&m.autorun||-1!==m.sendIntervalId||o||(m.sendIntervalId=setTimeout(function(){m.sendIntervalId=-1;0!==m.q.length&&BOOMR.sendBeaconWhenReady({"rt.start":"manual","http.initiator":"error",api:1,"rt.tstart":i,"rt.end":i},function(){m.addErrorsToBeacon()},this)},m.isDuringLoad?m.sendIntervalDuringLoad:m.sendInterval))}}},findDuplicateError:function(e,r){if(BOOMR.utils.isArray(e)&&void 0!==r)for(var n=0;n<e.length;n++)if(e[n].equals(r))return e[n]},mergeDuplicateErrors:function(e,r,n){if(BOOMR.utils.isArray(e)&&void 0!==r){var t=m.findDuplicateError(e,r);if(t){n&&(t.count+=r.count);return t}e.push(r)}},pageReady:function(){m.isDuringLoad=!1},getErrors:function(){return 0!==m.errors.length&&m.errors},getErrorsForUrl:function(e){e=m.compressErrors(e);return BOOMR.utils.serializeForUrl(e)},addErrorsToBeacon:function(){if(m.q.length){var e=this.getErrorsForUrl(m.q);e&&BOOMR.addVar("err",e,!0);m.q=[]}},beforeBeacon:function(e){e&&void 0!==e.early||m.addErrorsToBeacon()},wrapFn:function(o,i,s,a,u){var l,c=i[o];if("function"==typeof c){"addEventListener"===o&&(l=i.removeEventListener);BOOMR.utils.overwriteNative(i,o,function(){try{var e=Array.prototype.slice.call(arguments),r=e[a],n=s?this===window?BOOMR.window:this:i,t=m.wrap(r,n,u);e[a]=t;if("addEventListener"===o){if(!m.trackFn(n,e[0],r,e[2],t))return;l&&l.apply(n,arguments)}return c.apply(n,e)}catch(e){m.send(e,u);throw e}})}},trackFn:function(e,r,n,t,o){if(!e)return!1;if(-1!==m.trackedFnIdx(e,r,n,t))return!1;e._bmrEvents||(e._bmrEvents=[]);t=!0===(t&&t.capture||t);e._bmrEvents.push([r,n,t,o]);return!0},trackedFnIdx:function(e,r,n,t){var o,i;if(e){e._bmrEvents||(e._bmrEvents=[]);t=!0===(t&&t.capture||t);for(o=0;o<e._bmrEvents.length;o++)if((i=e._bmrEvents[o])[0]===r&&i[1]===n&&i[2]===t)return o;return-1}},wrapRemoveEventListener:function(e){var o,i,r="removeEventListener",s=e[r];"function"==typeof s&&BOOMR.utils.overwriteNative(e,r,function(e,r,n){var t=this===window?BOOMR.window:this;if(-1!==(o=m.trackedFnIdx(t,e,r,n))){i=t._bmrEvents[o][3];s.call(t,e,i,n);t._bmrEvents.splice(o,1)}else s.call(t,e,r,n)})},wrap:function(e,r,n){if("function"!=typeof e)return e;n=n||BOOMR.plugins.Errors.VIA_APP;BOOMR_check_doc_domain();return function(){try{return e.apply(r,arguments)}catch(e){if(-2146823277===e.number&&(n===BOOMR.plugins.Errors.VIA_EVENTHANDLER||n===BOOMR.plugins.Errors.VIA_TIMEOUT))return;BOOMR.isUnloaded||m.send(e,n);throw e}}},test:function(){var e;if(0!==arguments.length&&"function"==typeof(e=arguments[0])){var r=1<arguments.length?arguments[1]:BOOMR.window,n=Array.prototype.slice.call(arguments,2);return m.wrap(e,r).apply(r,n)}},normalizeToString:function(e){return void 0===e?"undefined":null===e?"null":"number"==typeof e&&isNaN(e)?"NaN":""===e?"(empty string)":0===e?"0":e?"function"==typeof e?"(function)":e&&"function"==typeof e.toString?e.toString():"(unknown)":"false"},compressErrors:function(e){for(var r,n,t,o,i,s,a,u=0,l=BOOMR.window.location.origin,c=0;c<e.length;c++){a={};1!==(n=e[c]).count&&(a.n=n.count);if("number"==typeof n.timestamp){u=n.timestamp;a.d=n.timestamp.toString(36)}if(n.frames.length){a.f=[];for(r=0;r<n.frames.length;r++){(t=n.frames[r]).lineNumber&&(t.lineNumber=parseInt(t.lineNumber,10));t.columnNumber&&(t.columnNumber=parseInt(t.columnNumber,10));i={l:t.lineNumber,c:t.columnNumber};"string"==typeof t.fileName&&(-1!==t.fileName.indexOf(l)?i.wo=t.fileName.replace(l,""):i.w=t.fileName);"string"==typeof t.functionName&&(i.f=t.functionName);a.f.push(i)}}if(n.events.length){a.e=[];for(r=0;r<n.events.length;r++){s={t:(o=n.events[r]).type,d:u?u-o.timestamp:o.timestamp};if(o.type===BOOMR.plugins.Errors.EVENT_CLICK){o.id&&(s.i=o.id);o.name&&(s.n=o.name);o.tagName&&(s.g=o.tagName)}else if(o.type===BOOMR.plugins.Errors.EVENT_NETWORK){o.url&&(s.u=o.url);o.method&&(s.m=o.method);o.result&&(s.r=o.result)}else if(o.type===BOOMR.plugins.Errors.EVENT_LOG){o.severity&&(s.s=o.severity);o.message&&(s.m=o.message)}a.e.push(s)}}n.source!==BOOMR.plugins.Errors.SOURCE_APP&&(a.s=n.source);void 0!==n.via&&n.via!==BOOMR.plugins.Errors.VIA_APP&&(a.v=n.via);void 0!==n.type&&"Error"!==n.type&&(a.t=n.type);n.code&&(a.c=n.code);n.message&&(a.m=n.message);n.extra&&(a.x=n.extra);e[c]=a}return e},decompressErrors:function(e){for(var r,n,t,o=BOOMR.window.location.origin,i=0;i<e.length;i++){(n=e[i]).n?n.count=parseInt(n.n,10):n.count=1;n.d&&(n.timestamp=parseInt(n.d,36));n.frames=[];n.m&&(n.message=n.m);n.stack=n.message?n.message+" ":"";if(n.f){for(r=0;r<n.f.length;r++){(t=n.f[r]).l&&(t.lineNumber=parseInt(t.l,10));t.c&&(t.columnNumber=parseInt(t.c,10));t.f&&(t.functionName=t.f);t.w&&(t.fileName=t.w);t.wo&&(t.fileName=o+t.wo);delete t.c;delete t.l;delete t.f;delete t.w;delete t.wo;n.frames.push(t);0!==r&&(n.stack+="\n");n.stack+="at";t.functionName&&(n.stack+=" "+t.functionName);t.functionName&&t.fileName?n.stack+=" ("+t.fileName:!t.functionName&&t.fileName&&(n.stack+=" "+t.fileName);t.lineNumber&&(n.stack+=":"+t.lineNumber);t.columnNumber&&(n.stack+=":"+t.columnNumber);t.functionName&&t.fileName&&(n.stack+=")")}n.lineNumber=n.frames[0].lineNumber;n.columnNumber=n.frames[0].columnNumber;n.functionName=n.frames[0].functionName;n.fileName=n.frames[0].fileName}n.events=n.e||[];n.source=n.s||BOOMR.plugins.Errors.SOURCE_APP;n.via=n.v||BOOMR.plugins.Errors.VIA_APP;n.type=n.t||"Error";n.x&&(n.extra=n.x);n.c&&(n.code=parseInt(n.c,10));delete n.c;delete n.f;delete n.e;delete n.s;delete n.v;delete n.t;delete n.m;delete n.n;delete n.x;delete n.d}return e}},i=BOOMR.plugins.Errors={init:function(e){var n,t;BOOMR.utils.pluginConfig(m,e,"Errors",["onError","monitorGlobal","monitorNetwork","monitorConsole","monitorEvents","monitorTimeout","monitorReporting","monitorRejections","sendAfterOnload","sendInterval","maxErrors"]);if(m.initialized)return this;e&&void 0!==e.autorun&&(m.autorun=e.autorun);m.initialized=!0;BOOMR.subscribe("before_beacon",m.beforeBeacon,null,m);BOOMR.subscribe("page_ready",m.pageReady,null,m);BOOMR.registerEvent("error");if(m.monitorGlobal)try{(!BOOMR.globalOnError||BOOMR.window.onerror&&!BOOMR.window.onerror._bmr)&&(BOOMR.globalOnError=BOOMR.window.onerror);BOOMR.utils.overwriteNative(BOOMR.window,"onerror",function(e,r,n,t,o){null!=(o=void 0===o&&"object"==typeof e&&"object"==typeof e.error&&null!==e.error?e.error:o)?m.send(o,i.VIA_GLOBAL_EXCEPTION_HANDLER):m.send({message:e,fileName:r,lineNumber:n,columnNumber:t,noStack:!0},i.VIA_GLOBAL_EXCEPTION_HANDLER);return"function"==typeof BOOMR.globalOnError&&BOOMR.globalOnError.apply(BOOMR.window,arguments)});if(BOOMR.globalErrors){for(var o=0;o<BOOMR.globalErrors.length;o++)m.send(BOOMR.globalErrors[o],i.VIA_GLOBAL_EXCEPTION_HANDLER);delete BOOMR.globalErrors}}catch(e){BOOMR.debug("Exception in the window.onerror handler","Errors")}m.monitorNetwork&&BOOMR.subscribe("xhr_error",function(e){m.send({code:e.status,message:e.url,noStack:!0},i.VIA_NETWORK)});m.monitorRejections&&BOOMR.window.PromiseRejectionEvent&&BOOMR.utils.addListener(BOOMR.window,"unhandledrejection",function(e){var r,n="Unhandled Promise Rejection";if(e&&e.reason){if("string"==typeof e.reason)n=e.reason;else{"string"==typeof e.reason.stack&&(r=e.reason.stack);n=void 0===e.reason.message?m.normalizeToString(e.reason):m.normalizeToString(e.reason.message)}m.send({message:n,stack:r,noStack:!r},i.VIA_REJECTION)}},!0);if(m.monitorConsole){BOOMR.window.console||(BOOMR.window.console={});BOOMR.globalConsole=BOOMR.window.console.error;try{BOOMR.utils.overwriteNative(BOOMR.window.console,"error",function(){var e=Array.prototype.slice.call(arguments);1===e.length?m.send(m.normalizeToString(e[0]),i.VIA_CONSOLE):m.send(m.normalizeToString(e),i.VIA_CONSOLE);"function"==typeof BOOMR.globalConsole&&("function"==typeof BOOMR.globalConsole.apply?BOOMR.globalConsole.apply(this,e):BOOMR.globalConsole(e[0],e[1],e[2]))})}catch(e){BOOMR.debug("Exception in the window.console.error handler","Errors")}}if(m.monitorEvents)if(BOOMR.window.EventTarget){m.wrapFn("addEventListener",BOOMR.window.EventTarget.prototype,!0,1,i.VIA_EVENTHANDLER);m.wrapRemoveEventListener(BOOMR.window.EventTarget.prototype)}else{if(BOOMR.window){m.wrapFn("addEventListener",BOOMR.window,!1,1,i.VIA_EVENTHANDLER);m.wrapRemoveEventListener(BOOMR.window)}if(BOOMR.window.Node){m.wrapFn("addEventListener",BOOMR.window.Node.prototype,!0,1,i.VIA_EVENTHANDLER);m.wrapRemoveEventListener(BOOMR.window.Node.prototype)}if(BOOMR.window.XMLHttpRequest){m.wrapFn("addEventListener",BOOMR.window.XMLHttpRequest.prototype,!0,1,i.VIA_EVENTHANDLER);m.wrapRemoveEventListener(BOOMR.window.XMLHttpRequest.prototype)}}if(m.monitorTimeout){m.wrapFn("setTimeout",BOOMR.window,!1,0,i.VIA_TIMEOUT);m.wrapFn("setInterval",BOOMR.window,!1,0,i.VIA_TIMEOUT)}if(m.monitorReporting&&BOOMR.window.ReportingObserver){m.reportingObserver=new BOOMR.window.ReportingObserver(function(e,r){if(BOOMR.utils.isArray(e))for(o=0;o<e.length;o++){n=e[o];(t=n&&n.body&&(n.body.message||n.body.reason))&&m.send({message:t,fileName:n.body.sourceFile||n.url,lineNumber:n.body.lineNumber,columnNumber:n.body.columnNumber,noStack:!0},i.VIA_REPORTING_API)}},{buffered:!0});m.reportingObserver.observe()}return this},is_complete:function(){return!0},is_supported:function(){return m.initialized},SOURCE_APP:1,SOURCE_BOOMERANG:2,VIA_APP:1,VIA_GLOBAL_EXCEPTION_HANDLER:2,VIA_NETWORK:3,VIA_CONSOLE:4,VIA_EVENTHANDLER:5,VIA_TIMEOUT:6,VIA_REJECTION:7,VIA_REPORTING_API:8,EVENT_CLICK:1,EVENT_NETWORK:2,EVENT_LOG:3,send:m.send,wrap:m.wrap,test:m.test,BoomerangError:N,findDuplicateError:m.findDuplicateError,mergeDuplicateErrors:m.mergeDuplicateErrors,compressErrors:m.compressErrors,decompressErrors:m.decompressErrors,normalizeToString:m.normalizeToString}}function N(e){"number"==typeof(e=e||{}).count||"string"==typeof e.count?this.count=parseInt(e.count,10):this.count=1;"number"==typeof e.timestamp?this.timestamp=e.timestamp:this.timestamp=BOOMR.now();"number"!=typeof e.code&&"string"!=typeof e.code||(this.code=parseInt(e.code,10));"string"==typeof e.message&&(this.message=e.message);"string"==typeof e.functionName&&(this.functionName=e.functionName);"string"==typeof e.fileName&&(this.fileName=e.fileName);"number"!=typeof e.lineNumber&&"string"!=typeof e.lineNumber||(this.lineNumber=parseInt(e.lineNumber,10));"number"!=typeof e.columnNumber&&"string"!=typeof e.columnNumber||(this.columnNumber=parseInt(e.columnNumber,10));"string"==typeof e.stack&&(this.stack=e.stack);"string"==typeof e.type&&(this.type=e.type);void 0!==e.extra&&(this.extra=e.extra);this.source="number"==typeof e.source||"string"==typeof e.source?parseInt(e.source,10):BOOMR.plugins.Errors.SOURCE_APP;"number"!=typeof e.via&&"string"!=typeof e.via||(this.via=parseInt(e.via,10));BOOMR.utils.isArray(e.frames)?this.frames=e.frames:this.frames=[];BOOMR.utils.isArray(e.events)?this.events=e.events:this.events=[]}}();
//# sourceMappingURL=errors.min.js.map