!function(){var s={monitorHistory:!0,enabled:!0,hooked:!1,routeChangeInProgress:!1,disableHardNav:!1,routeFilter:void 0,routeChangeWaitFilter:void 0,monitorReplaceState:!0,a:void 0,browserOnloadBeforeSetup:!1,DEPRECATED_PLUGINS:["Angular","Backbone","Ember"],resetRouteChangeInProgress:function(e){if(!e||!(void 0!==e.early||e["http.initiator"]&&0===e["http.initiator"].indexOf("api_custom_"))){u("resetting routeChangeInProgress");s.routeChangeInProgress&&clearTimeout(s.routeChangeInProgress);s.routeChangeInProgress=!1}},setRouteChangeInProgress:function(){s.routeChangeInProgress&&clearTimeout(s.routeChangeInProgress);s.routeChangeInProgress=setTimeout(s.resetRouteChangeInProgress,50)},routeChange:function(e){if(s.enabled)if(!s.disableHardNav||BOOMR.onloadFired())if(s.routeChangeInProgress)u("routeChangeInProgress, not triggering");else{u("routeChange triggered, sending route_change() event");if(e.toUrl){s.a.href=e.toUrl;e.toUrl=s.a.href}BOOMR.plugins.SPA.route_change(null,[e.type,e.fromUrl,e.toUrl])}else u("disableHardNav and not page_ready, not triggering");else{u("Not enabled - we've missed a routeChange");s.resetRouteChangeInProgress()}}};BOOMR=window.BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};if(!BOOMR.plugins.History&&void 0!==BOOMR.plugins.SPA&&void 0!==BOOMR.plugins.AutoXHR&&BOOMR.window&&BOOMR.window.document){BOOMR.plugins.SPA.register("History");s.a=BOOMR.window.document.createElement("A");BOOMR.plugins.History={is_complete:function(){return!0},hook:function(e,t,o){try{u("hook: "+JSON.stringify(o))}catch(e){u("hook: can't stringify options")}(o=o||{}).disableHardNav=s.disableHardNav;s.routeFilter&&(o.routeFilter=s.routeFilter);s.routeChangeWaitFilter&&(o.routeChangeWaitFilter=s.routeChangeWaitFilter);!s.hooked&&s.monitorHistory&&function(){var n,i,t,e,o,r=BOOMR.window.history;"function"==typeof r.pushState&&(r.pushState=(n=r.pushState,function(e,t,o){u("pushState, title: "+t+" url: "+o);s.routeChange({type:"pushState",fromUrl:BOOMR.window.document.URL,toUrl:o});return n.apply(this,arguments)}));s.monitorReplaceState&&"function"==typeof r.replaceState&&(r.replaceState=(i=r.replaceState,function(e,t,o){var n=BOOMR.window.document.URL,r=n;if(3<=arguments.length&&null!=o){s.a.href=o;r=s.a.href}if(BOOMR.plugins.SPA.isSpaNavInProgress()&&r===n)u("replaceState ignored (no URL change and a SPA nav is in progress), title: "+t+" url: "+o);else{u("replaceState, title: "+t+" url: "+o);s.routeChange({type:"pushState",fromUrl:BOOMR.window.document.URL,toUrl:o})}return i.apply(this,arguments)}));"function"==typeof r.go&&(r.go=(t=r.go,function(e){u("go");s.routeChange({type:"go",fromUrl:BOOMR.window.document.URL});return t.apply(this,arguments)}));"function"==typeof r.back&&(r.back=(e=r.back,function(){u("back");s.routeChange({type:"back",fromUrl:BOOMR.window.document.URL});return e.apply(this,arguments)}));"function"==typeof r.forward&&(r.forward=(o=r.forward,function(){u("forward");s.routeChange({type:"forward",fromUrl:BOOMR.window.document.URL});return o.apply(this,arguments)}));BOOMR.window.addEventListener("hashchange",function(e){e=(e||{}).newURL;u("hashchange "+e);s.routeChange({type:"hashchange",toUrl:e})});function a(){BOOMR.window.addEventListener("popstate",function(e){u("popstate");s.routeChange({type:"popstate",toUrl:BOOMR.window.document.URL})})}BOOMR.hasBrowserOnloadFired()?a():BOOMR.window.addEventListener("load",function(){setTimeout(a,0)});BOOMR.subscribe("beacon",s.resetRouteChangeInProgress);BOOMR.subscribe("spa_cancel",s.resetRouteChangeInProgress);BOOMR.subscribe("spa_init",s.setRouteChangeInProgress);s.browserOnloadBeforeSetup=BOOMR.hasBrowserOnloadFired()}();t=s.browserOnloadBeforeSetup;BOOMR.plugins.SPA.hook(t,o);if(!s.hooked&&!s.browserOnloadBeforeSetup&&(!s.disableHardNav||BOOMR.onloadFired())){BOOMR.plugins.SPA.route_change();s.setRouteChangeInProgress()}s.hooked=!0;return this},init:function(e){BOOMR.utils.pluginConfig(s,e,"History",["enabled","monitorHistory","disableHardNav","routeFilter","routeChangeWaitFilter","monitorReplaceState"]);s.enabled&&this.hook();return this},disable:function(){s.enabled=!1;return this},enable:function(){s.enabled=!0;return this}};for(var e=0;e<s.DEPRECATED_PLUGINS.length;e++){var t=s.DEPRECATED_PLUGINS[e];BOOMR.plugins[t]=BOOMR.plugins.History;BOOMR.plugins[t]={init:function(t){return function(e){BOOMR.utils.pluginConfig(s,e,t,["enabled"]);if(s.enabled){u("Deprecated: Initialized from "+t+" config");BOOMR.plugins.History.hook(void 0,void 0,{})}return BOOMR.plugins[t]}}(t),enable:BOOMR.plugins.History.enable,hook:BOOMR.plugins.History.hook,is_complete:BOOMR.plugins.History.is_complete};BOOMR.plugins.SPA.register(t)}}function u(e){BOOMR.debug(e,"History")}}();
//# sourceMappingURL=history.min.js.map