!function(){BOOMR=window.BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};if(!BOOMR.plugins.ResourceTiming){var m={other:0,img:1,link:2,script:3,css:4,xmlhttprequest:5,html:6,image:7,beacon:8,fetch:9,iframe:"a",subdocument:"a",body:"b",input:"c",frame:"a",object:"d",video:"e",audio:"f",source:"g",track:"h",embed:"i",eventsource:"j",navigation:6},b={prefetch:1,preload:2,prerender:3,stylesheet:4},M=["startTime","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","workerStart"],f="\n",l="*",g="0",h="1",S="2",A=1,w=2,k=4,O="3",T="4",v="5",y="6",_={complete:!1,sentNavBeacon:!1,initialized:!1,supported:null,xhr_load:function(){if(!this.complete){this.complete=!0;BOOMR.sendBeacon()}},xssBreakWords:[/(h)(ref)/gi,/(s)(rc)/gi,/(a)(ction)/gi],urlLimit:500,clearOnBeacon:!1,trimUrls:[],serverTiming:!0,monitorClearResourceTimings:!1,splitAtPath:!1,getSrcsetDimensions:!1,trackedResourceTypes:"*",done:function(){if(!this.sentNavBeacon){e();this.complete=!0;this.sentNavBeacon=!0;BOOMR.sendBeacon()}},onBeacon:function(e){var t=BOOMR.getPerformance();if(_.clearOnBeacon&&t){var r=t.clearResourceTimings||t.webkitClearResourceTimings;r&&"function"==typeof r&&r.call(t)}},prerenderToVisible:function(){this.sentNavBeacon=!1;this.done()}};BOOMR.plugins.ResourceTiming={init:function(e){BOOMR.utils.pluginConfig(_,e,"ResourceTiming",["xssBreakWords","clearOnBeacon","urlLimit","trimUrls","trackedResourceTypes","serverTiming","monitorClearResourceTimings","splitAtPath","getSrcsetDimensions"]);if(_.initialized)return this;if(this.is_supported()){BOOMR.subscribe("page_ready",_.done,null,_);BOOMR.subscribe("prerender_to_visible",_.prerenderToVisible,null,_);BOOMR.subscribe("xhr_load",_.xhr_load,null,_);BOOMR.subscribe("beacon",_.onBeacon,null,_);BOOMR.subscribe("before_unload",_.done,null,_);if(_.monitorClearResourceTimings){var t=this;BOOMR.window.performance.clearResourceTimings=(r=BOOMR.window.performance.clearResourceTimings,function(){t.addResources(BOOMR.window.performance.getEntriesByType("resource"));r.apply(BOOMR.window.performance,arguments)})}}else _.complete=!0;var r;_.initialized=!0;return this},is_complete:function(){return!0},is_enabled:function(){return _.initialized&&this.is_supported()},is_supported:function(){if(null!==_.supported)return _.supported;var e=BOOMR.getPerformance();_.supported=e&&"function"==typeof e.getEntriesByType&&void 0!==window.PerformanceResourceTiming;return _.supported},addResources:function(e,t){if(this.is_supported()&&BOOMR.utils.isArray(e)){_.collectedEntries=_.collectedEntries||[];if("number"==typeof t){var n=t-(BOOMR.window.performance.timeOrigin||BOOMR.window.performance.timing.navigationStart);e=BOOMR.utils.arrayFilter(e,function(e){for(var t=0;t<M.length;t++){var r=M[t];e.hasOwnProperty(r)&&(e[r]+=n)}return!0})}Array.prototype.push.apply(_.collectedEntries,e)}},getCompressedResourceTiming:r,getFilteredResourceTiming:D,calculateResourceTimingUnion:function(e){if(!e||!e.length)return 0;e.sort(function(e,t){return e.fetchStart!==t.fetchStart?e.fetchStart-t.fetchStart:(e.responseStart||e.responseEnd)-(t.responseStart||t.responseEnd)});for(var t=c(e),r=[],n=0,i=0;i<t.length;i++){var o=t[i];o.fetchStart<n&&(o.fetchStart=n);if(o.fetchStart<o.responseEnd){r.push(o);n=o.responseEnd}}var a=c(r),s=0;for(i=0;i<a.length;i++)s+=a[i].responseEnd-a[i].fetchStart;return s},addResourceTimingToBeacon:e,addToBeacon:n,trimTiming:P,roundUpTiming:R,convertToTrie:B,optimizeTrie:E,findPerformanceEntriesForFrame:C,toBase36:x,getVisibleEntries:I,reduceFetchStarts:c,compressSize:U,decompressSize:function(e,t){var r,n;void 0===t&&(t={});r=e.split(",");for(n=0;n<r.length;n++)if("_"===r[n])r[n]=0;else{""===r[n]&&(r[n]=0);r[n]=parseInt(r[n],36);0<n&&(r[n]+=r[0])}1===r.length&&r.push(r[0]);2===r.length&&r.push(r[0]);t.encodedBodySize=r[0];t.transferSize=r[1];t.decodedBodySize=r[2];return t},trimUrl:W,getResourceLatestTime:Y,mergePixels:j,countPixels:F,getOptimizedTimepoints:function(e){for(var t,r,n,i,o,a,s,c,u={},d=[],f=Object.keys(e),p=0;p<f.length;p++){void 0===u[n=Math.round(Number(f[p]))]&&(u[n]=[]);Array.prototype.push.apply(u[n],e[f[p]])}if(0===(f=Object.keys(u).map(Number).sort(function(e,t){return e-t})).length)return{};for(p=0;p<f.length;p++){o=F(t=j(t,u[n=f[p]],n));f[p]=[n,o]}for(p=a=i=r=0;p<f.length;p++){n=f[p][0];o=f[p][1];s=F(t,0,n);if(i<o||a<s){c=(c=(n===1/0?"":x(Math.round(n-r)))+"~"+x(o-i)+"~"+x(o-s)).replace(/~~/,"-").replace(/~$/,"");d.push(c);r=n;i=o;a=s}}return d.join("!").replace(/!+$/,"")},decompressTimePoints:function(e){for(var t,r={},n=[0,0,0],i=e.split("!"),o=0;o<i.length;o++)r[(t=i[o].replace(/^~/,"Infinity~").replace("-","~0~").split("~").map(function(e,t){e="Infinity"===e?1/0:parseInt(e,36);2===t?e=n[1]-e:e+=n[t];return n[t]=e}))[0]]=[t[1],t[2]||t[1]];return r},accumulateServerTimingEntries:d,compressServerTiming:p,indexServerTiming:q,identifyServerTimingEntry:$,decompressServerTiming:function(e,t){var r=t.split(":"),n=Number(r[0]),i=0,t=0;if(1<r.length){var o=r[1].split(".");""!==o[0]&&(i=Number(o[0]));1<o.length&&(t=Number(o[1]))}var a,o="";if(Array.isArray(e[i])){a=e[i][0];o=e[i][1+t]||""}else a=e[i];return{name:a,duration:n,description:o}},SPECIAL_DATA_PREFIX:l,SPECIAL_DATA_DIMENSION_TYPE:g,SPECIAL_DATA_SIZE_TYPE:h,SPECIAL_DATA_SCRIPT_ATTR_TYPE:S,SPECIAL_DATA_LINK_ATTR_TYPE:T,SPECIAL_DATA_SERVICE_WORKER_TYPE:y,ASYNC_ATTR:A,DEFER_ATTR:w,LOCAT_ATTR:k,INITIATOR_TYPES:m,REL_TYPES:b}}function B(e,t){var r,n,i,o,a,s,c,u,d={};for(r in e){n=r;for(i=0;i<_.xssBreakWords.length;i++)n=n.replace(_.xssBreakWords[i],"$1"+f+"$2");if(e.hasOwnProperty(r)){o=e[r];a=t?[(a=n.split("/"))[0]+"//",a[2]+(3<a.length?"/":"")].concat(a.slice(3).reduce(function(o){return function(e,t,r){var n,i;if(-1!==t.indexOf(f)){n=t.split(f);for(i=0;i<n.length-1;i++){e.push(n[i]);e.push(f)}t=n.slice(-1)}"number"==typeof o&&r<o&&(t+="/");return e.concat(t)}}(a.length-4),[])):n.split("");c=d;for(i=0;i<a.length;i++)void 0===(u=c[s=a[i]])?c=c[s]=i===a.length-1?o:{}:"string"==typeof u?c=c[s]={"|":u}:i===a.length-1?c[s]["|"]=o:c=c[s]}}return d}function E(e,t){var r,n,i=0,o=[];for(r in e)e.hasOwnProperty(r)&&o.push(r);for(var a=0;a<o.length;a++){r=o[a];if("object"==typeof e[r]&&(n=E(e[r],!1))){delete e[r];if(r===f){r=n.name;i++}else r+=n.name;e[r]=n.value}i++}if(1!==i)return!!t&&e;if(t){(t={})[r]=e[r];return t}return{name:r,value:e[r]}}function R(e){"number"!=typeof e&&(e=0);return Math.ceil(e||0)}function P(e,t){"number"!=typeof e&&(e=0);"number"!=typeof t&&(t=0);e=Math.round(e||0),t=Math.round(t||0);return 0===e?0:e-t}function L(e){try{e.location&&e.location.href;e.document;if("performance"in e&&e.performance)return 1}catch(e){}}function z(e){var t=0;return t=L(e)&&e.performance.timing&&e.performance.timing.navigationStart?e.performance.timing.navigationStart:t}function C(e,t,r,n,i){var o,a,s,c,u,d,f,p,m,l,g=[],h={},S={};void 0===t&&(t=!0);void 0===r&&(r=0);if(10<(n=void 0===n?0:n))return g;try{if(!L(e))return g;s=z(e);m=I(e,i);N(l=e.document.createElement("a"),h,"script");N(l,S,"link");if((d=e.document.getElementsByTagName("iframe"))&&d.length)for(o=0;o<d.length;o++){c=z(d[o].contentWindow);u=0;s<c&&(u=r+(c-s));l.href=d[o].src;g=g.concat(C(d[o].contentWindow,!1,u,n+1,m[l.href]))}if("function"!=typeof e.performance.getEntriesByType)return g;function O(e){return _.serverTiming&&e.serverTiming||[]}if(t)if((a=e.performance.getEntriesByType("navigation"))&&1===a.length){f=a[0];g.push({name:e.location.href,startTime:0,initiatorType:"html",redirectStart:f.redirectStart,redirectEnd:f.redirectEnd,fetchStart:f.fetchStart,domainLookupStart:f.domainLookupStart,domainLookupEnd:f.domainLookupEnd,connectStart:f.connectStart,secureConnectionStart:f.secureConnectionStart,connectEnd:f.connectEnd,requestStart:f.requestStart,responseStart:f.responseStart,responseEnd:f.responseEnd,workerStart:f.workerStart,encodedBodySize:f.encodedBodySize,decodedBodySize:f.decodedBodySize,transferSize:f.transferSize,serverTiming:O(f)})}else e.performance.timing&&0!==(p=e.performance.timing).navigationStart&&p.responseEnd<=p.navigationStart+36e5&&g.push({name:e.location.href,startTime:0,initiatorType:"html",redirectStart:p.redirectStart?p.redirectStart-p.navigationStart:0,redirectEnd:p.redirectEnd?p.redirectEnd-p.navigationStart:0,fetchStart:p.fetchStart?p.fetchStart-p.navigationStart:0,domainLookupStart:p.domainLookupStart?p.domainLookupStart-p.navigationStart:0,domainLookupEnd:p.domainLookupEnd?p.domainLookupEnd-p.navigationStart:0,connectStart:p.connectStart?p.connectStart-p.navigationStart:0,secureConnectionStart:p.secureConnectionStart?p.secureConnectionStart-p.navigationStart:0,connectEnd:p.connectEnd?p.connectEnd-p.navigationStart:0,requestStart:p.requestStart?p.requestStart-p.navigationStart:0,responseStart:p.responseStart?p.responseStart-p.navigationStart:0,responseEnd:p.responseEnd?p.responseEnd-p.navigationStart:0});var T=e.performance.getEntriesByType("resource"),v=[];if(e===BOOMR.window&&_.collectedEntries){Array.prototype.push.apply(T,_.collectedEntries);_.collectedEntries=[]}for(o=0;T&&o<T.length;o++){for(var y={name:(p=T[o]).name,initiatorType:p.initiatorType,encodedBodySize:p.encodedBodySize,decodedBodySize:p.decodedBodySize,transferSize:p.transferSize,serverTiming:O(p),visibleDimensions:m[p.name],latestTime:Y(p)},B=0;B<M.length;B++){var E=M[B];y[E]="startTime"===E||p[E]?p[E]+r:0}p.hasOwnProperty("_data")&&(y._data=p._data);if(("script"===p.initiatorType||"link"===p.initiatorType)&&h[p.name]){var R=h[p.name];y.scriptAttrs=(R.async?A:0)|(R.defer?w:0);for(;1===R.nodeType&&"BODY"!==R.nodeName;)R=R.parentNode;y.scriptAttrs|="BODY"===R.nodeName?k:0}"link"===p.initiatorType&&S[p.name]&&BOOMR.utils.arrayFind(S[p.name].rel.split(/[\u0009\u000A\u000C\u000D\u0020]+/),function(e){e=e.toLowerCase();if(b[e]){y.linkAttrs=b[e];return!0}});v.push(y)}g=g.concat(v)}catch(e){return g}return g}function N(t,r,e){Array.prototype.forEach.call(t.ownerDocument.getElementsByTagName(e),function(e){t.href=e.currentSrc||e.src||"function"==typeof e.getAttribute&&e.getAttribute("xlink:href")||e.href;t.href.match(/^https?:\/\//)&&(r[t.href]=e)})}function x(e){return"number"==typeof e&&0!==e?e.toString(36):"string"==typeof e?e:""}function I(e,t){var c={},u=e.document,d=u.createElement("A"),f=(t=t||[0,0,0,0])[3]+(void 0!==e.pageXOffset)?e.pageXOffset:(u.documentElement||u.body.parentNode||u.body).scrollLeft,p=t[2]+(void 0!==e.pageYOffset)?e.pageYOffset:(u.documentElement||u.body.parentNode||u.body).scrollTop;["img","iframe","image"].forEach(function(e){for(var t,r,n,i,o,a=u.getElementsByTagName(e),s=0;s<a.length;s++)if(o=a[s]){r=o.currentSrc||o.src||"function"==typeof o.getAttribute&&o.getAttribute("src")||o.getAttribute("xlink:href");d.href=r;r=d.href;if(r&&!c[r]&&((t=o.getBoundingClientRect()).height||o.offsetHeight)&&(t.width||o.offsetWidth)){c[r]=[t.height||o.offsetHeight,t.width||o.offsetWidth,Math.round(t.top+p),Math.round(t.left+f)];if(o.naturalHeight||o.naturalWidth){_.getSrcsetDimensions&&o.currentSrc&&(o.srcset||o.parentNode&&o.parentNode.nodeName&&"PICTURE"===o.parentNode.nodeName.toUpperCase())?(n=o.isConnected?o.ownerDocument.createElement("IMG"):new BOOMR.window.Image).src=r:n=o;i=n.naturalHeight||o.naturalHeight;o=n.naturalWidth||o.naturalWidth;!i&&!o||c[r][0]===i&&c[r][1]===o||c[r].push(i,o)}}}});return c}function D(e,t,r){var n,i=C(BOOMR.window,!0,0,0),o=z(BOOMR.window),a={};if(!i||!i.length)return{entries:[]};i.sort(function(e,t){return e.startTime-t.startTime});for(var s=[],c=0;c<i.length;c++){n=i[c];if((0===n.name.indexOf("http:")||0===n.name.indexOf("https:"))&&!(-1<n.name.indexOf(BOOMR.url)||-1<n.name.indexOf(BOOMR.config_url)||"function"==typeof BOOMR.getBeaconURL&&BOOMR.getBeaconURL()&&-1<n.name.indexOf(BOOMR.getBeaconURL())||e&&o+n.startTime<e)){if(t&&o+n.startTime>t)break;if(void 0===r||"*"===r||!r.length||n.initiatorType&&BOOMR.utils.inArray(n.initiatorType,r)){d(a,n.serverTiming);s.push(n)}}}var u=p(a);return{entries:s,serverTiming:{lookup:u,indexed:q(u)}}}function U(e){var t,r;if(e.encodedBodySize||e.decodedBodySize||e.transferSize){t=e.transferSize;return[r=e.encodedBodySize,t?t-r:"_",(e=e.decodedBodySize)?e-r:0].map(x).join(",").replace(/,+$/,"")}return""}function W(e,t){var r,n,i;if(e&&t)for(r=0;r<t.length;r++)if("string"==typeof(i=t[r])){if(-1!==(n=e.indexOf(i))){e=e.substr(0,n+i.length)+"...";break}}else i instanceof RegExp&&i.test(e)&&(e=e.replace(i,"$1")+"...");return BOOMR.utils.cleanupURL(e,_.urlLimit)}function Y(e){return e.responseEnd||(e.responseStart&&e.startTime?e.responseStart+.2*(e.responseStart-e.startTime):1/0)}function j(e,t,c){var r=BOOMR.window.screen,u=r.height,d=r.width;return t.reduce(function(e,t){var r,n,i=Math.max(0,t[3]),o=Math.max(0,t[2]),a=Math.min(t[3]+t[1],d),s=Math.min(t[2]+t[0],u);if(a<=i||s<=o)return e;for(n=o;n<s;n++){e[n]||(e[n]=[]);for(r=i;r<a;r++)e[n][r]=c}return e},e||[])}function F(e,r,n){r=r||0;n=n||1/0;return e.reduce(function(e,t){return e+t.filter(function(e){return r<=e&&e<=n}).length},0)}function r(e,t){var r,n={},i={},t=D(e,t,_.trackedResourceTypes),o=t.entries,a=t.serverTiming;if(!o||!o.length)return{restiming:{},servertiming:[]};for(r=0;r<o.length;r++){var s=o[r],c=(u=void 0===(u=m[s.initiatorType])?0:u)+[P(s.startTime,0),P(s.responseEnd,s.startTime),P(s.responseStart,s.startTime),P(s.requestStart,s.startTime),P(s.connectEnd,s.startTime),P(s.secureConnectionStart,s.startTime),P(s.connectStart,s.startTime),P(s.domainLookupEnd,s.startTime),P(s.domainLookupStart,s.startTime),P(s.redirectEnd,s.startTime),P(s.redirectStart,s.startTime)].map(x).join(",").replace(/,+$/,""),u=U(s);""!==u&&(c+=l+h+u);s.hasOwnProperty("scriptAttrs")&&(c+=l+S+s.scriptAttrs);s.serverTiming&&s.serverTiming.length&&(c+=l+O+s.serverTiming.reduce(function(e,t,r){var n=String(void 0!==t.duration?t.duration:t.value);"0."===n.substring(0,2)&&(n=n.substring(1));var i=t.name||t.metric;return e+=(0<r?",":"")+n+$(a.indexed[i].index,a.indexed[i].descriptions[t.description])},""));s.hasOwnProperty("linkAttrs")&&(c+=l+T+s.linkAttrs);if(s.workerStart&&"number"==typeof s.workerStart&&0!==s.workerStart){var d=P(R(s.workerStart),s.startTime);c+=l+y+x(d)}d=W(s.name,_.trimUrls);if(s.hasOwnProperty("_data")){var f,p="";for(f in s._data)s._data.hasOwnProperty(f)&&(p+=l+v+f+":"+s._data[f]);void 0===n[d]?n[d]=c+p:n[d]+=p}else void 0!==n[d]?n[d]+="|"+c:s.visibleDimensions?n[d]=l+g+s.visibleDimensions.map(Math.round).map(x).join(",").replace(/,+$/,"")+"|"+c:n[d]=c;if(s.visibleDimensions){i[s.latestTime]||(i[s.latestTime]=[]);i[s.latestTime].push(s.visibleDimensions)}}return{restiming:E(B(n,_.splitAtPath),!0),servertiming:a.lookup}}function c(e){var t=[];if(!e||!e.length)return t;for(var r=0;r<e.length;r++){var n=e[r];r!==e.length-1&&n.fetchStart===e[r+1].fetchStart||t.push({fetchStart:n.fetchStart,responseEnd:n.responseStart||n.responseEnd})}return t}function e(e,t){if("undefined"!=typeof JSON){BOOMR.utils.mark("restiming:build:start");t=r(e,t);BOOMR.utils.mark("restiming:build:end");BOOMR.utils.measure("restiming:build","restiming:build:start","restiming:build:end");if(t){BOOMR.info("Client supports Resource Timing API","restiming");n(t)}}}function d(r,e){(e||[]).forEach(function(e){var t=e.name||e.metric;void 0===r[t]&&(r[t]={count:0,counts:{}});t=r[t];t.counts[e.description]=t.counts[e.description]||0;t.counts[e.description]++;t.count++})}function p(n){return Object.keys(n).sort(function(e,t){return n[t].count-n[e].count}).reduce(function(e,r){var t=Object.keys(n[r].counts).sort(function(e,t){return n[r].counts[t]-n[r].counts[e]});e.push(1===t.length&&""===t[0]?r:[r].concat(t));return e},[])}function q(e){return e.reduce(function(e,t,r){var n,i;if(Array.isArray(t)){n=t[0];i=t.slice(1).reduce(function(e,t,r){e[t]=r;return e},{})}else{n=t;i={"":0}}e[n]={index:r,descriptions:i};return e},{})}function $(e,t){var r="";e&&(r+=e);t&&(r+="."+t);return r=r.length?":"+r:r}function n(e){BOOMR.addVar("restiming",JSON.stringify(e.restiming),!0);e.servertiming.length&&BOOMR.addVar("servertiming",BOOMR.utils.serializeForUrl(e.servertiming),!0)}}();
//# sourceMappingURL=restiming.min.js.map