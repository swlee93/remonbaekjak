!function(){var d,s,l,f,O,c=["uninitialized","open","responseStart","domInteractive","responseEnd"],p=-999,h=-997;BOOMR=window.BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};if(!BOOMR.plugins.AutoXHR&&(d=BOOMR.window)&&d.XMLHttpRequest&&(new d.XMLHttpRequest).addEventListener){u.stop=function(){u.pause();u.observer=null};u.pause=function(){if(u.observer&&u.observer.observer&&!u.isPaused){u.isPaused=!0;u.observer.observer.disconnect()}};u.resume=function(){if(u.observer&&u.observer.observer&&u.isPaused){u.isPaused=!1;u.observer.observer.observe(s,u.observer.config)}};u.start=function(){if(!u.observer){var e={childList:!0,attributes:!0,subtree:!0,attributeFilter:["src","href"]};if(u.observer=BOOMR.utils.addObserver(s,e,null,l.mutation_cb,null,l)){u.observer.config=e;BOOMR.subscribe("page_unload",u.stop,null,u)}}};u.prototype.addEvent=function(e){for(var t,n,r={type:e.initiator,resource:e,nodes_to_wait:0,total_nodes:0,resources:[],complete:!1,aborted:!1,firedEarlyBeacon:!1},i=this.pending_events.length,o=this,s=i-1;0<=s;s--)if(this.pending_events[s]&&!this.pending_events[s].complete){t=this.pending_events[s];n=s;break}if(t)if("click"===t.type){if(0===t.nodes_to_wait||!t.resource.url){this.pending_events[n]=void 0;this.watch--}}else if("xhr"===t.type){if("click"===r.type)return null;if("xhr"===r.type){l.add_event_resource(e);return null}}else if(BOOMR.utils.inArray(t.type,BOOMR.constants.BEACON_TYPE_SPAS)){if("xhr"===r.type){l.add_event_resource(e);return null}if(BOOMR.utils.inArray(r.type,BOOMR.constants.BEACON_TYPE_SPAS)){R("Aborting previous SPA navigation");t.resource.timing.loadEventEnd=BOOMR.now();t.aborted=!0;this.sendEvent(n)}}if("click"===r.type){if(!u.observer)return null;this.setTimeout(O.xhrIdleTimeout,i)}else if("xhr"===r.type){r.nodes_to_wait++;r.total_nodes++;r.ignoreMO=!0}else if(BOOMR.utils.inArray(r.type,BOOMR.constants.BEACON_TYPE_SPAS)){u.start();if(e.wait){r.nodes_to_wait++;r.total_nodes++;e.waitComplete=function(){o.load_finished(i);e.waitComplete=void 0}}else this.setTimeout(O.spaIdleTimeout,i)}this.watch++;this.pending_events.push(r);return e.index=i};u.prototype.sendEvent=function(e){var t=this.pending_events[e],n=this;BOOMR.now();if(t&&!t.complete){this.clearTimeout(e);if(BOOMR.readyToSend()){t.complete=!0;this.watch--;t.resource.resources=t.resources;BOOMR.utils.inArray(t.type,BOOMR.constants.BEACON_TYPE_SPAS)&&(t.resource.url=s.URL);if("spa"!==t.type||0!==t.total_nodes||t.resource.url!==n.lastSpaLocation){if(BOOMR.utils.inArray(t.type,BOOMR.constants.BEACON_TYPE_SPAS)){n.lastSpaLocation=t.resource.url;if(!t.forced){"spa"===t.type&&0===t.total_nodes&&(t.resource.timing.loadEventEnd=t.resource.timing.requestStart+1);if("spa_hard"===t.type){var r=BOOMR.getPerformance();r&&r.timing&&r.timing.loadEventEnd&&t.resource.timing.loadEventEnd&&t.resource.timing.loadEventEnd<r.timing.loadEventEnd&&(t.resource.timing.loadEventEnd=r.timing.loadEventEnd)}}}this.sendResource(t.resource,e)}else{R("SPA beacon cancelled, no URL change or resources triggered");BOOMR.fireEvent("spa_cancel");this.pending_events[e]=void 0}}else setTimeout(function(){n.sendEvent(e)},500)}};u.prototype.sendResource=function(n,r){function t(e,t){e&&(n.timing.loadEventEnd=t||BOOMR.now());BOOMR.real_sendBeacon();n.onComplete&&n.onComplete(n);if(BOOMR.plugins.ResourceTiming&&BOOMR.plugins.ResourceTiming.is_enabled()&&n.timing&&n.timing.requestStart){t=BOOMR.plugins.ResourceTiming.getCompressedResourceTiming(n.timing.requestStart,n.timing.loadEventEnd);BOOMR.plugins.ResourceTiming.addToBeacon(t)}if(BOOMR.utils.inArray(n.initiator,BOOMR.constants.BEACON_TYPE_SPAS)){i.calculateSpaTimings(n);if("number"==typeof r&&i.pending_events[r].aborted){BOOMR.addVar("pgu",s.URL,!0);BOOMR.addVar("rt.quit","",!0);BOOMR.addVar("rt.abld","",!0)}}BOOMR.responseEnd(n,o,n);"number"==typeof r&&(i.pending_events[r]=void 0)}var i=this,e=i.pending_events[r],o=n.timing?n.timing.requestStart:void 0;"spa_hard"!==n.initiator||e&&e.aborted||BOOMR.hasBrowserOnloadFired()?t(!1):BOOMR.utils.addListener(d,"load",function(){var e=BOOMR.now();BOOMR.setImmediate(function(){t(!0,e)})})};u.prototype.calculateSpaTimings=function(e){var t=BOOMR.getPerformance();if(t&&t.timing)if("spa_hard"===e.initiator){e.timing.responseEnd=t.timing.responseStart;e.timing.fetchStart=t.timing.navigationStart}else if(BOOMR.plugins.ResourceTiming&&BOOMR.plugins.ResourceTiming.is_supported()){var n=BOOMR.plugins.ResourceTiming.getFilteredResourceTiming(e.timing.requestStart,e.timing.loadEventEnd,O.spaBackEndResources).entries,r=Math.round(e.timing.loadEventEnd-e.timing.requestStart);if(n&&n.length){for(var i=e.timing.loadEventEnd-t.timing.navigationStart,o=0;o<n.length;o++)if(n[o].responseStart>i){n[o].responseStart=i;n[o].responseEnd=i}else n[o].responseEnd>i&&(n[o].responseEnd=i);var s=Math.round(BOOMR.plugins.ResourceTiming.calculateResourceTimingUnion(n)),t=r-s;s<0||r<0||t<0?BOOMR.addError("Incorrect SPA time calculation"):e.timers={t_resp:s,t_page:t,t_done:r}}else e.timers={t_resp:0,t_page:r,t_done:r}}};u.prototype.setTimeout=function(e,t){var n=this;if(e){this.clearTimeout(t);this.timer=setTimeout(function(){n.timedout(t)},e)}};u.prototype.timedout=function(e){var t;this.clearTimeout(e);if(t=this.pending_events[e])if(!BOOMR.utils.inArray(t.type,BOOMR.constants.BEACON_TYPE_SPAS)||BOOMR.hasBrowserOnloadFired()){if(0===t.nodes_to_wait)if("click"!==t.type||0!==t.total_nodes&&t.resource.url)this.sendEvent(e);else{this.watch--;this.pending_events[e]=void 0}}else this.setTimeout(1e3,e)};u.prototype.clearTimeout=function(e){if(this.timer&&e===this.pending_events.length-1){clearTimeout(this.timer);this.timer=null}};u.prototype.load_cb=function(e,t){var n=BOOMR.now(),r=e.target||e.srcElement;if(r&&r._bmr){e=r._bmr.idx;t=void 0!==t?t:r._bmr.res||0;if(!r._bmr.end[t]){r._bmr.end[t]=n;this.load_finished(e,n)}}};u.prototype.monitorMO=function(e){e=this.pending_events[e];e&&delete e.ignoreMO};u.prototype.load_finished=function(e,t){var n=this.pending_events[e];if(n){n.nodes_to_wait--;if(0===n.nodes_to_wait){n.resource.timing.loadEventEnd=t||BOOMR.now();if(e===this.pending_events.length-1)if(BOOMR.utils.inArray(n.type,BOOMR.constants.BEACON_TYPE_SPAS)){if(!n.firedEarlyBeacon&&BOOMR.plugins.Early&&BOOMR.plugins.Early.is_supported()){if(this.timerEarlyBeacon){clearTimeout(this.timerEarlyBeacon);this.timerEarlyBeacon=null}this.timerEarlyBeacon=setTimeout(function(){l.timerEarlyBeacon=null;if(!n.firedEarlyBeacon&&0===n.nodes_to_wait){n.firedEarlyBeacon=!0;BOOMR.plugins.Early.sendEarlyBeacon(n.resource,n.type)}},100)}this.setTimeout(O.spaIdleTimeout,e)}else this.setTimeout(O.xhrIdleTimeout,e);else this.sendEvent(e)}}};u.prototype.wait_for_node=function(t,n){var r,i,o,e,s,u,a,d,l=this,c=!1,p=!1;if(t&&t.nodeName&&(t.nodeName.toUpperCase().match(/^(IMG|IFRAME|IMAGE)$/)||"LINK"===t.nodeName.toUpperCase()&&t.rel&&t.rel.match(/\bstylesheet\b/i))){t._bmr&&"number"==typeof t._bmr.res&&t._bmr.end[t._bmr.res]&&(p=!0);e=t.src||"function"==typeof t.getAttribute&&t.getAttribute("xlink:href")||t.href;if(p=t._bmr&&t._bmr.url!==e?!0:p){if("function"==typeof t._bmr.listener){l.load_cb({target:t,type:"changed"});t.removeEventListener("load",t._bmr.listener);t.removeEventListener("error",t._bmr.listener);delete t._bmr.listener}R("mutation URL changed from "+t._bmr.url+" to "+e+" for event idx: "+t._bmr.idx+" node:"+t._bmr.res)}if(!e||e.match(/^(about:|javascript:|data:)/i))return!1;if("IMG"===t.nodeName){if(t.naturalWidth&&!p)return!1;if("function"==typeof t.getAttribute&&""===t.getAttribute("src"))return!1}if("IFRAME"===t.nodeName&&p)return!1;if("function"==typeof t.getAttribute){u=parseInt(t.getAttribute("height"),10);a=parseInt(t.getAttribute("width"),10)}isNaN(u)&&(u=!t.style||"0"!==t.style.height&&"0px"!==t.style.height&&"1px"!==t.style.height?void 0:0);isNaN(a)&&(a=!t.style||"0"!==t.style.width&&"0px"!==t.style.width&&"1px"!==t.style.width?void 0:0);if(!isNaN(u)&&u<=1&&!isNaN(a)&&a<=1)return!1;if(t.style&&"none"===t.style.display)return!1;if(t.style&&"hidden"===t.style.visibility)return!1;if(!(a=this.pending_events[n]))return!1;s=a.resources.length;a.urls||(a.urls={});if(a.urls[e])return!1;if(!a.resource.url){f.href=e;if(O.excludeFilter(f)){R("Exclude for "+f.href+" matched. Excluding");return!1}a.resource.url=f.href}t._bmr||(t._bmr={end:{}});t._bmr.res=s;t._bmr.idx=n;delete t._bmr.end[s];t._bmr.url=e;d=function(e){l.load_cb(e,s);t.removeEventListener("load",d);t.removeEventListener("error",d);delete t._bmr.listener;R("mutation URL on"+e.type+", for event idx: "+n+" node: "+s)};R("Monitoring mutation URL: "+e+" for event idx: "+n+" node: "+s);t._bmr.listener=d;t.addEventListener("load",d);t.addEventListener("error",d);a.nodes_to_wait++;this.clearTimeout(n);a.total_nodes++;a.resources.push(t);a.urls[e]=1;c=!0}else t.nodeType===Node.ELEMENT_NODE&&["IMAGE","IMG"].forEach(function(e){if((r=t.getElementsByTagName(e))&&r.length)for(i=0,o=r.length;i<o;i++)c|=this.wait_for_node(r[i],n)},this);return c};u.prototype.add_event_resource=function(e){var t,n=this.pending_events.length-1;if(n<0)return-1;if(!(t=this.pending_events[n]))return-1;if(!e)return-1;R("Monitoring "+e.type+" URL: "+e.url+" for event id: "+n);t.nodes_to_wait++;t.total_nodes++;e.index=n;e.node=!0;return n};u.prototype.mutation_cb=function(e){var i,o,s;if(!this.watch)return!0;if((o=(i=this).pending_events.length-1)<0||!this.pending_events[o])return!0;if((s=this.pending_events[o]).ignoreMO)return!0;void 0===s.interesting&&(s.interesting=!1);if(e&&e.length){s.resource.timing.domComplete=BOOMR.now();e.forEach(function(e){var t,n,r;if("attributes"===e.type)s.interesting|=i.wait_for_node(e.target,o);else if("childList"===e.type){n=e.addedNodes.length;for(t=0;t<n;t++)s.interesting|=i.wait_for_node(e.addedNodes[t],o);n=e.removedNodes.length;for(t=0;t<n;t++)"IFRAME"===(r=e.removedNodes[t]).nodeName&&r._bmr&&i.load_cb({target:r,type:"removed"})}})}if(!s.interesting&&!s.timeoutExtended){this.setTimeout(1e3,o);s.timeoutExtended=!0}return!0};u.prototype.queue_is_empty=function(){return 0===this.nodesWaitingFor()};u.prototype.nodesWaitingFor=function(e){if(0===this.pending_events.length)return 0;void 0===e&&(e=this.pending_events.length-1);return(e=this.pending_events[e])?e.nodes_to_wait:0};u.prototype.completeEvent=function(e){var t,n=BOOMR.now();if(0!==this.pending_events.length){void 0===e&&(e=this.pending_events.length-1);if(t=this.pending_events[e]){t.resource.timing.loadEventEnd=n;t.forced=!0;this.sendEvent(e)}}};l=new u;O={spaBackEndResources:["xmlhttprequest","script","fetch"],alwaysSendXhr:!1,excludeFilters:[],initialized:!1,captureXhrRequestResponse:!1,singlePageApp:!1,autoXhrEnabled:!1,monitorFetch:!1,fetchBodyUsedWait:200,spaIdleTimeout:1e3,xhrIdleTimeout:50,excludeFilter:function(e){var t,n;if(!e||!e.href)return!1;for(t=0;t<O.excludeFilters.length;t++)if("function"==typeof O.excludeFilters[t].cb){n=O.excludeFilters[t].ctx;O.excludeFilters[t].name&&R("Running filter: "+O.excludeFilters[t].name+" on URL: "+e.href);try{if(O.excludeFilters[t].cb.call(n,e)){R("Found matching filter at: "+O.excludeFilters[t].name+" for URL: "+e.href);return!0}}catch(e){BOOMR.addError(e,"BOOMR.plugins.AutoXHR.impl.excludeFilter()")}}return!1},loadFinished:function(t,e){var n,r,i;e=e||BOOMR.now();if(!t.timing.loadEventEnd){t.status&&BOOMR.fireEvent("xhr_error",t);t.timing.loadEventEnd=e;if((i=BOOMR.getPerformance())&&i.timing){r=i.timing.navigationStart;if(n=BOOMR.getResourceTiming(t.url,function(e,t){return e.responseEnd-t.responseEnd},function(e){return Math.ceil(r+e.startTime+2)>=t.timing.requestStart&&0!==e.responseEnd})){e=Math.floor(r+n.startTime);if((i=Math.floor(r+n.responseEnd))<=BOOMR.now()){t.timing.responseEnd=i;t.timing.loadEventEnd<i&&(t.timing.loadEventEnd=i);t.timing.requestStart=e;t.timing.fetchStart=e;0!==n.responseStart&&(t.timing.responseStart=Math.floor(r+n.responseStart));t.restiming=n}}}t.node&&a(t.url,O.alwaysSendXhr)&&l.sendResource(t);if(0<=t.index){l.monitorMO(t.index);l.load_finished(t.index,t.timing.responseEnd)}}}};BOOMR.plugins.AutoXHR={is_complete:function(){return!0},init:function(e){var t,n;s=d.document;if(d&&s){f=s.createElement("A");BOOMR.utils.pluginConfig(O,e,"AutoXHR",["spaBackEndResources","alwaysSendXhr","monitorFetch","fetchBodyUsedWait","spaIdleTimeout","xhrIdleTimeout"]);BOOMR.instrumentXHR=_;BOOMR.uninstrumentXHR=M;BOOMR.instrumentFetch=m;BOOMR.uninstrumentFetch=g;if(!O.initialized){this.addExcludeFilter(o,null,"shouldExcludeXhr");O.initialized=!0}if(e&&e.AutoXHR&&e.AutoXHR.excludeFilters&&0<e.AutoXHR.excludeFilters.length)for(n=0;n<e.AutoXHR.excludeFilters.length;n++)O.excludeFilters.push(e.AutoXHR.excludeFilters[n]);O.autoXhrEnabled=e.instrument_xhr;O.singlePageApp=BOOMR.plugins.SPA&&BOOMR.plugins.SPA.isSinglePageApp(e);if(O.alwaysSendXhr&&O.autoXhrEnabled&&BOOMR.xhr&&"function"==typeof BOOMR.xhr.stop){function r(e){if(e.length)for(t=0;t<e.length;t++)y(e[t]);else y(e)}var i=BOOMR.xhr.stop(r);i&&i.length&&BOOMR.setImmediate(r,i)}if(O.singlePageApp){O.alwaysSendXhr||(O.autoXhrEnabled=!1);if(O.autoXhrEnabled){BOOMR.instrumentXHR();BOOMR.instrumentFetch()}}else if(O.autoXhrEnabled){BOOMR.instrumentXHR();BOOMR.instrumentFetch()}else if(!1===O.autoXhrEnabled){BOOMR.uninstrumentXHR();BOOMR.uninstrumentFetch()}BOOMR.registerEvent("xhr_error")}},getMutationHandler:function(){return l},getPathname:n,enableAutoXhr:function(){if(!O.autoXhrEnabled){BOOMR.instrumentXHR();BOOMR.instrumentFetch()}O.autoXhrEnabled=!0},addExcludeFilter:function(e,t,n){O.excludeFilters.push({cb:e,ctx:t,name:n})},setXhrRequestResponseCapturing:function(e){O.captureXhrRequestResponse=e},matchesAlwaysSendXhr:a}}function R(e){BOOMR.debug(e,"AutoXHR")}function n(e){if(!e)return null;e.href=e.href;e=e.pathname;return e="/"!==e.charAt(0)?"/"+e:e}function o(e){var t;if(e.href){if(e.href.match(/^(about:|javascript:|data:)/i))return!0;if("function"==typeof BOOMR.getBeaconURL&&BOOMR.getBeaconURL()&&(0===(t=e.href.indexOf(BOOMR.getBeaconURL()))||5===t||6===t))return!0}return BOOMR.xhr_excludes.hasOwnProperty(e.href)||BOOMR.xhr_excludes.hasOwnProperty(e.hostname)||BOOMR.xhr_excludes.hasOwnProperty(n(e))}function u(){this.watch=0;this.timer=null;this.timerEarlyBeacon=null;this.pending_events=[];this.lastSpaLocation=null}function a(e,t){var n,r;if(!t||!e)return!1;if("boolean"==typeof t)return!0===t;if("function"==typeof t)try{return!0===t(e)}catch(e){return!1}if(BOOMR.utils.isArray(t))for(n=0;n<t.length;n++){if("string"==typeof(r=t[n])&&r===e)return!0;if(r instanceof RegExp&&r.test(e))return!0}return!1}function m(){if(O.monitorFetch&&"function"==typeof d.fetch&&"function"==typeof d.Request&&"function"==typeof d.Response&&"function"==typeof d.Promise&&"function"==typeof window.fetch&&!d.fetch.polyfill&&(!BOOMR.proxy_fetch||BOOMR.proxy_fetch!==d.fetch))if(BOOMR.proxy_fetch&&BOOMR.orig_fetch&&BOOMR.orig_fetch===d.fetch)d.fetch=BOOMR.proxy_fetch;else{BOOMR.orig_fetch=d.orig_fetch||d.fetch;BOOMR.proxy_fetch=function(e,t){console.log("proxy_fetch",e,t);var n,r,i,o={timing:{},initiator:"xhr"};if("object"==typeof e&&e instanceof d.Request){n=e.url;r=t&&t.method||e.method||"GET";O.captureXhrRequestResponse&&(i=t&&t.body||e.body||void 0)}else{n=e;r=t&&t.method||"GET";O.captureXhrRequestResponse&&(i=t&&t.body||void 0)}f.href=n;if(O.excludeFilter(f)){BOOMR.debug("Exclude found for resource: "+f.href+" Skipping Fetch instrumentation!","AutoXHR");return BOOMR.orig_fetch.apply(d,arguments)}BOOMR.fireEvent("xhr_init","fetch");o.url=f.href;o.method=r;o.type="fetch";i&&(o.requestPayload=i);BOOMR.fireEvent("xhr_send",{resource:o});l.addEvent(o);try{o.timing.requestStart=BOOMR.now();console.log("proxy_fetch.arguments",arguments);var s=BOOMR.orig_fetch.apply(this,arguments);function u(n,r,i){function o(){var e;if(i.fetchResponse&&!i.fetchResponse.bodyUsed&&O.fetchBodyUsedWait){e=BOOMR.now();i.responseBodyNotUsed=!0;setTimeout(function(){O.loadFinished(i,e)},O.fetchBodyUsedWait)}else O.loadFinished(i)}return function(){var e,t=n._bmrNextP;try{e=r.apply(this===window?d:this,arguments);for(;t&&!t._bmrHasOnFulfilled;)t=t._bmrNextP;t||(e instanceof d.Promise?e.then=a(e,e.then,i):o());return e}catch(e){for(;t&&!t._bmrHasOnRejected;)t=t._bmrNextP;t||o();throw e}}}function a(t,n,r){return t._bmrNextP?n:function(){var e=Array.prototype.slice.call(arguments);if(0<e.length){if("function"==typeof e[0]){e[0]=u(t,e[0],r);t._bmrHasOnFulfilled=!0}if(1<e.length&&"function"==typeof e[1]){e[1]=u(t,e[1],r);t._bmrHasOnRejected=!0}}e=n.apply(t,e);(t._bmrNextP=e).then=a(e,e.then,r);return e}}s.then=a(s,s.then,o);return s.then(function(e){var t,n=!1,r=!1;e.redirected&&(o.responseUrl=e.url);(e.status<200||400<=e.status)&&(o.status=e.status);o.fetchResponse=e;0<=o.index&&l.monitorMO(o.index);if(O.captureXhrRequestResponse&&"function"==typeof e.clone){if(t=e.headers.get("content-type")){n=-1!==t.indexOf("json");r=-1!==t.indexOf("xml")}o.response={};try{e.clone().text().then(function(e){o.response.text=e;o.response.raw=e;r&&"function"==typeof d.DOMParser&&(o.response.xml=(new d.DOMParser).parseFromString(e,"text/xml"))}).then(null,function(e){})}catch(e){}if(n)try{e.clone().json().then(function(e){o.response.json=e}).then(null,function(e){})}catch(e){}}return e},function(e){!e||"AbortError"!==e.name&&20!==e.code?o.status=-998:o.status=p;throw e})}catch(e){o.status=h;O.loadFinished(o);throw e}};BOOMR.utils.overwriteNative(d,"fetch",BOOMR.proxy_fetch)}}function g(){"function"==typeof d.fetch&&BOOMR.orig_fetch&&BOOMR.orig_fetch!==d.fetch&&(d.fetch=BOOMR.orig_fetch)}function _(){if(!BOOMR.proxy_XMLHttpRequest||BOOMR.proxy_XMLHttpRequest!==d.XMLHttpRequest)if(BOOMR.proxy_XMLHttpRequest&&BOOMR.orig_XMLHttpRequest&&BOOMR.orig_XMLHttpRequest===d.XMLHttpRequest){d.XMLHttpRequest=BOOMR.proxy_XMLHttpRequest;u.start()}else{BOOMR.orig_XMLHttpRequest=d.orig_XMLHttpRequest||d.XMLHttpRequest;u.start();BOOMR.subscribe("click",function(){if(!O.singlePageApp){var e={timing:{},initiator:"click"};if(BOOMR.orig_XMLHttpRequest&&BOOMR.orig_XMLHttpRequest!==d.XMLHttpRequest){e.timing.requestStart=BOOMR.now();l.addEvent(e)}}});BOOMR.proxy_XMLHttpRequest=function(){console.log("proxy_XMLHttpRequest");var i={timing:{},initiator:"xhr"},o=!1,s=!1,u=new BOOMR.orig_XMLHttpRequest,a=u.open,t=u.send;u.open=function(e,t,n){console.log("proxy_XMLHttpRequest.req.open");f.href=t;if(O.excludeFilter(f)){s=!0;R("Exclude found for resource: "+f.href+" Skipping XHR instrumentation!");return a.apply(u,arguments)}s=!1;void 0===n&&(n=!0);BOOMR.fireEvent("xhr_init","xhr");function r(e,t){u.addEventListener(e,function(){if("readystatechange"===e){i.timing[c[u.readyState]]=BOOMR.now();if(4===u.readyState&&0!==u.status){u.responseURL!==i.url&&(i.responseUrl=u.responseURL);(u.status<200||400<=u.status)&&(i.status=u.status);if(O.captureXhrRequestResponse){i.response={text:""===u.responseType||"text"===u.responseType?u.responseText:null,xml:""===u.responseType||"document"===u.responseType?u.responseXML:null,raw:u.response,json:u.responseJSON};if(u.response&&u.response.constructor&&u.response.constructor===BOOMR.boomerang_frame.Object&&BOOMR.boomerang_frame.Object!==d.Object)try{u.response.constructor=d.Object}catch(e){}}O.loadFinished(i)}else if(0===u.readyState&&"number"==typeof i.timing.open){u.responseURL!==i.url&&(i.responseUrl=u.responseURL);i.status=p;O.loadFinished(i)}}else{u.responseURL!==i.url&&(i.responseUrl=u.responseURL);"load"===e?0!==u.status&&(u.status<200||400<=u.status)&&(i.status=u.status):i.status=void 0===t?u.status:t;O.loadFinished(i)}},!1)}if(!o){n&&r("readystatechange");r("load");r("timeout",-1001);r("error",-998);r("abort",p)}i.url=f.href;i.method=e;i.type="xhr";delete i.status;n||(i.synchronous=!0);o=!0;try{return a.apply(u,arguments)}catch(e){i.status=h;O.loadFinished(i);throw e}};u.send=function(e){console.log("proxy_XMLHttpRequest.req.send");u.setRequestHeader("mtid","test");if(s)return t.apply(u,arguments);O.captureXhrRequestResponse&&(u.resource.requestPayload=e);BOOMR.fireEvent("xhr_send",u);l.addEvent(i);i.timing.requestStart=BOOMR.now();return void 0===i.status||i.status!==h?t.apply(u,arguments):void 0};u.resource=i;return u};BOOMR.proxy_XMLHttpRequest.UNSENT=0;BOOMR.proxy_XMLHttpRequest.OPENED=1;BOOMR.proxy_XMLHttpRequest.HEADERS_RECEIVED=2;BOOMR.proxy_XMLHttpRequest.LOADING=3;BOOMR.proxy_XMLHttpRequest.DONE=4;BOOMR.proxy_XMLHttpRequest.prototype=BOOMR.orig_XMLHttpRequest.prototype;BOOMR.utils.overwriteNative(d,"XMLHttpRequest",BOOMR.proxy_XMLHttpRequest)}}function M(){BOOMR.orig_XMLHttpRequest&&BOOMR.orig_XMLHttpRequest!==d.XMLHttpRequest&&(d.XMLHttpRequest=BOOMR.orig_XMLHttpRequest)}function y(e){e.initiator="xhr";BOOMR.responseEnd(e)}}();
//# sourceMappingURL=auto-xhr.min.js.map