# Migration `20210301074904-new-migration`

This migration has been generated by swlee at 3/1/2021, 4:49:04 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "Subject" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "name" TEXT NOT NULL,
    "description" TEXT,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "createdById" TEXT NOT NULL
)

CREATE TABLE "Observer" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "name" TEXT NOT NULL,
    "description" TEXT,
    "subjectId" INTEGER NOT NULL,

    FOREIGN KEY ("subjectId") REFERENCES "Subject"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE TABLE "Log" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "type" TEXT NOT NULL,
    "level" TEXT NOT NULL,
    "title" TEXT NOT NULL,
    "message" TEXT NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "subjectId" INTEGER NOT NULL,
    "observerId" INTEGER NOT NULL,

    FOREIGN KEY ("subjectId") REFERENCES "Subject"("id") ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY ("observerId") REFERENCES "Observer"("id") ON DELETE CASCADE ON UPDATE CASCADE
)
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20210301074904-new-migration
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,70 @@
+datasource db {
+  provider = "sqlite" 
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id       Int    @id @default(autoincrement())
+  name     String
+  email    String @unique
+  password String
+  links    Link[]
+  votes    Vote[]
+}
+
+model Vote {
+  id     Int  @id @default(autoincrement())
+  link   Link @relation(fields: [linkId], references: [id])
+  linkId Int
+  user   User @relation(fields: [userId], references: [id])
+  userId Int
+
+  @@unique([linkId, userId])
+}
+
+model Link {
+  id          Int      @id @default(autoincrement())
+  createdAt   DateTime @default(now())
+  description String
+  url         String
+  postedBy    User     @relation(fields: [postedById], references: [id])
+  postedById  Int
+  votes       Vote[]
+}
+
+
+model Subject {
+  id            Int @id @default(autoincrement())
+  name          String
+  description   String?
+  createdAt     DateTime @default(now())
+  createdById   String
+  observers     Observer[]
+  logs          Log[]
+}
+
+model Observer {
+  id            Int @id @default(autoincrement())
+  name          String
+  description   String?
+  subject       Subject     @relation(fields: [subjectId], references: [id])
+  subjectId     Int  
+  logs          Log[]
+}
+
+model Log {
+  id          Int @id @default(autoincrement()) 
+  type        String
+  level       String
+  title       String
+  message     String
+  createdAt   DateTime @default(now())
+  subject     Subject @relation(fields: [subjectId], references: [id])
+  subjectId Int
+  observer    Observer @relation(fields: [observerId], references: [id])
+  observerId Int
+}
```


